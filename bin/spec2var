#!/bin/bash

for opt in "$@"; do
   optarg="$(expr "${opt}" : '[^=]*=\(.*\)')"
   case "${opt}" in
      --spec=*) SPEC="${optarg}" ;;
      --archs=*) ARCHS="${optarg}" ;;
   esac
done

for arch in ${ARCHS//,/ } ; do
   macros="/usr/lib/rpm/macros:macros/${arch}:macros/shared"

   # Populate variables for the capabilities provided by package names.
   rpmspec --macros "${macros}" --query --queryformat="%{NAME} = \$(OUTPUT)/%{NAME}-%{VERSION}-%{RELEASE}.%{ARCH}.rpm\n" "${SPEC}"
done
